# Analysis Operating System

You are working on a multi-session time series exploratory data analysis project. This file tells you how to operate.

## Document Locations

All project management documents live in `docs/`:

| Document | Path | Purpose |
|----------|------|---------|
| Analysis Brief | `docs/analysis-brief.md` | Data context, goals, constraints, decisions. READ THIS FIRST every session. |
| Scope | `docs/scope.md` | Analysis phases, dependencies, risks. |
| Data Profile | `docs/data-profile.md` | Living dataset characterization — accumulates across sessions. |
| Domain Context | `docs/domain-context.md` | Application-specific constraints, methods, pitfalls, vocabulary. Generated by `/intake`. |
| Intake Notes | `docs/intake-notes.md` | Raw interview notes from `/intake`. |
| Handoff Notes | `docs/handoff-notes/session-NN.md` | What happened in each past session. |
| Lessons Log | `docs/lessons-log.md` | Analysis-specific gotchas — data quirks, method pitfalls, domain knowledge. |

Analysis work products live in `notebooks/` and `reports/`:

| Location | Purpose |
|----------|---------|
| `notebooks/` | Jupyter notebooks — the working surface for analysis. |
| `data/raw/` | Untouched source data. Never modify files here. |
| `data/processed/` | Cleaned and transformed data. |
| `reports/` | Synthesized findings and recommendations — the deliverables. |

## Session Protocol

### Starting a session
1. Read `docs/analysis-brief.md` (always — no exceptions)
2. Read `docs/domain-context.md` (understand the application domain's constraints and methods)
3. Read `docs/data-profile.md` (understand what's known about the data so far)
4. Read `docs/lessons-log.md` (skim for relevant entries)
5. Read the GitHub issue you've been assigned (or check the brief's "Next task" field)
6. Read the most recent handoff note in `docs/handoff-notes/`
7. Confirm your understanding of the task before starting work

### During a session
- If you discover something new about the data, update `docs/data-profile.md` immediately — don't wait until the end.
- State your hypotheses BEFORE running analysis. This prevents seeing patterns everywhere.
- Stay within the scope defined in the GitHub issue. If you discover something interesting but out of scope, note it in the handoff — don't chase it.
- Verify your results before reporting findings. Check statistical assumptions. Sanity-check against domain knowledge.

### Ending a session
When told to wrap up (or when you finish the task), produce a handoff note and save it to `docs/handoff-notes/session-NN.md`. Update `docs/analysis-brief.md` with any new decisions and current status.

## Slash Commands

The following custom commands are available:

- `/intake` — Generate domain context + structured interview to understand data, domain, and business questions
- `/brief` — Generate the analysis brief from intake notes
- `/scope` — Define analysis phases, dependencies, and risks
- `/decompose` — Break an analysis phase into session-sized tasks (hypothesis-driven GitHub Issues)
- `/start` — Begin an analysis session (7-phase: load → hypothesize → design → validate data → analyze → validate results → report)
- `/review` — Methodological review (run in a separate session from `/start`)
- `/handoff` — End a session and produce the handoff note
- `/synthesize` — Pull all findings into recommendations — the actual deliverable

## Opinionated Stack

This project uses a specific Python stack. Use these tools unless you have a strong reason not to, and document exceptions in the lessons log.

**Core analysis:** pandas, numpy, scikit-learn, statsmodels, scipy
**Time series:** sktime, tsfresh
**Visualization:** plotly (interactive, preferred for EDA), matplotlib + seaborn (static, preferred for reports)
**Package management:** uv (default), conda (alternative)

## Principles
- You have no memory between sessions. These documents ARE your memory. Trust them.
- The analysis brief is the source of truth. If something contradicts it, ask the user.
- The data profile is a living document. Every session should leave it richer than it was found.
- Hypothesize before analyzing. State what you expect to find, then look. This is not optional.
- Data surprises are findings, not problems. Document them, don't hide them.
- The deliverable is insights and recommendations, not notebooks. Notebooks are the working surface, `reports/` is where value lives.
- Keep the analysis brief under 1,000 words. Be ruthless about conciseness.
- Every analysis includes validation. "The chart looks right" is not validation. Check assumptions, test significance, sanity-check against domain knowledge.
- Decisions made in previous sessions are recorded in the analysis brief. Don't re-litigate them unless the user asks you to.
